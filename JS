


(function() {
    
 

    var listaFuncionarios = [];
    
    function salvarFuncionario(){
        var funcionarios = {};
    
        funcionarios.nome =$("#nomeFuncionario").val();
        funcionarios.cpf = $("#cpfFuncionario").val();
        funcionarios.rg = $("#rgFuncionario").val();
        funcionarios.idade = $("#idadeFuncionario").val();
        funcionarios.telefone = $("#telefoneFuncionario").val();
        funcionarios.endereco = $("#enderecoFuncionario").val();
        funcionarios.profissao = $('#profissao-funcionario').val();
        funcionarios.cidades = $('#cidade-funcionario').val();

        let id = $("#id").val();
    
        // não tenho código = criar novo
        if(id == undefined || id == ''){
            funcionarios.id = new Date().getTime();
            listaFuncionarios.push(funcionarios);
        } else { // se tenho id, estou editando
            let idNumber = parseInt(id);
            let funcionariosExistentes = findFuncionariosById(idNumber);
            
            if(funcionariosExistentes){
                funcionariosExistentes.nome = funcionarios.nome;
                funcionariosExistentes.cpf = funcionarios.cpf;
                funcionariosExistentes.rg = funcionarios.rg;
                funcionariosExistentes.idades = funcionarios.idade;
                funcionariosExistentes.telefone = funcionarios.telefone;
                funcionariosExistentes.endereco = funcionarios.endereco;
                funcionariosExistentes.profissao = funcionarios.profissao;
                funcionariosExistentes.cidades= funcionarios.cidades;
                
            }
        }
    
        gravaNoLocalStorage();
        renderizaFuncionario();
        renderizaSelectProfissao();
        renderizaSelectCidade();
        zerarInputsFuncionario();

    
        return false;
    };
    function findFuncionariosById(id){
        let funcionarios = listaFuncionarios
            .filter(function(value){
                return value.id == id;
            });
        
        if(funcionarios.length == 0){
            return undefined;
        }else{
            return funcionarios[0];
        }
    };

    
    function zerarInputsFuncionario(){
        $('#formularios input').val('');
    };

    
    function renderizaFuncionario(){
        
        const tbody = $("#corpo-tabela-funcionarios");
        tbody.html('');
    
        for(let i=0; i<listaFuncionarios.length; i++){
           
            const funcionarios = listaFuncionarios[i];

            let tr = $('<tr>');

            let tdnomeFuncionarios = $('<td>').text(funcionarios.nome);
            let tdcpfFuncionarios = $('<td>').text(funcionarios.cpf);
            let tdrgFuncionarios = $('<td>').text(funcionarios.rg);
            let tdidadeFuncionarios = $('<td>').text(funcionarios.idade);
            let tdtelefoneFuncionarios = $('<td>').text(funcionarios.telefone);
            let tdenderecoFuncionarios = $('<td>').text(funcionarios.endereco);
            let tdprofissao = $('<td>').text(funcionarios.profissao);
            let tdcidades = $('<td>').text(funcionarios.cidades);
           
            let tdOpcoes = $('<td>');
    
            let btnEditarFuncionario = $('<button>').text('Editar');
            let btnExcluirFuncionario = $('<button>').text('Excluir');
            
            // associa o click a uma function
            btnEditarFuncionario.click(function(){ 
                EditarFuncionario(funcionarios.id); 
            });
    
            // associa o click a uma function
            btnExcluirFuncionario.click(function(){ 
                ExcluirFuncionario(funcionarios.id); 
            });
            
            tdOpcoes.append(btnEditarFuncionario).append(btnExcluirFuncionario);
    
            
            tr.append(tdnomeFuncionarios)
            .append(tdcpfFuncionarios)
            .append(tdrgFuncionarios)
            .append(tdidadeFuncionarios)
            .append(tdtelefoneFuncionarios)
            .append(tdenderecoFuncionarios)
            .append(tdprofissao)
            .append(tdcidades)
            .append(tdOpcoes);
    
            
            tbody.append(tr);
        }
    };
    
    function EditarFuncionario(id){
       let funcionarios = findFuncionariosById(id);
    
        if(funcionarios){
            $("#nomeFuncionario").val(funcionarios.nome);
            $("#cpfFuncionario").val(funcionarios.cpf);
            $("#rgFuncionario").val(funcionarios.rg);
            $("#idadeFuncionario").val(funcionarios.idade);
            $("#telefoneFuncionario").val(funcionarios.telefone);
            $("#enderecoFuncionario").val(funcionarios.endereco);
            $('#profissao-funcionario').val(funcionarios.profissao);
            $('#cidade-funcionario').val(funcionarios.cidades);
            $("#id").val(funcionarios.id);

        }else{
            alert('Não foi possível encontrar o funcionário');
        };
    };
    
    
    function ExcluirFuncionario(id){
       
        listaFuncionarios = listaFuncionarios
            .filter(function(value){
                return value.id != id;
            });
    
        gravaNoLocalStorage();
        renderizaFuncionario();
        renderizaSelectProfissao();
        renderizaSelectCidade();
    };
    
   
    
    function gravaNoLocalStorage(){
        // convertendo a lista em string no formato JSON
        const listaEmJSON = JSON.stringify(listaFuncionarios);
    
        // gravando no localStorage
        localStorage.setItem("listaFuncionario", listaEmJSON);
    };
    
    function buscaDoLocalStorage(){
        // busca do local storage
        const listaStorage = localStorage.getItem("listaFuncionario");
    
        // converte para lista e atribui
        listaFuncionarios = JSON.parse(listaStorage) || [];
    };
    
        // o que se deseja executar
        buscaDoLocalStorage();
        renderizaFuncionario();
        renderizaSelectCidade();
    
        $("#formularios").on("submit", function(evt){
                salvarFuncionario();
                // corta a linha de execucao
                evt.stopPropagation(); 
    
                // previne o comportamento padrão
                evt.preventDefault();
            });
        
        
   
        














    //Profissao
var listaProfissao = [];
    
function salvarProfissao(){
 
    var profissao = {};

    profissao.nome = $("#nomeProfissao").val();
    profissao.cargaHoraria = $("#cargaHorariaProfissao").val();
    profissao.salario = $("#salarioProfissao").val();

    let id = $("#id").val();

    // não tenho código = criar novo
    if(id == undefined || id == ''){
        profissao.id = new Date().getTime();
        listaProfissao.push(profissao);
        } else { // se tenho id, estou editando
         let idNumberS = parseInt(id);
            let profissaoExixtentes = findProfissaoById(idNumberS);
        
        if(profissaoExixtentes){
            profissaoExixtentes.nome = profissao.nome;
            profissaoExixtentes.cargaHoraria = profissao.cargaHoraria;
            profissaoExixtentes.salario =profissao.salario;
           
        }
    }

    gravaNoLocalStorageProfissao();
    renderizaProfissao();
    renderizaSelectProfissao();
    zerarInputsProfissao();

    return false;
};



function renderizaProfissao(){
        
    const tbody = $("#corpo-tabela-profissao");
    tbody.html('');

    for(let i=0; i<listaProfissao.length; i++){
       
        const profissao = listaProfissao[i];

        let tr = $('<tr>');

        let tdNome = $('<td>').text(profissao.nome);
        let tdCargaHoraria = $('<td>').text(profissao.cargaHoraria);
        let tdSalario = $('<td>').text(profissao.salario);
        let tdOpcoes = $('<td>');

        let btnEditarProfissao = $('<button>').text('Editar');
        let btnExcluirProfissao = $('<button>').text('Excluir');
        
        // associa o click a uma function
        btnEditarProfissao.click(function(){ 
            editarProfissao(profissao.id); 
        });

        // associa o click a uma function
        btnExcluirProfissao.click(function(){ 
            excluirProfissao(profissao.id); 
        });
        
        tdOpcoes.append(btnEditarProfissao).append(btnExcluirProfissao);

        
        tr.append(tdNome).append(tdCargaHoraria).append(tdSalario).append(tdOpcoes);

        
        tbody.append(tr);
    }
};

function editarProfissao(id){
    renderizaSelectProfissao();
    let profissao = findProfissaoById(id);
 
     if(profissao){
         $("#nomeProfissao").val(profissao.nome);
         $("#cargaHorariaProfissao").val(profissao.cargaHoraria);
         $("#salarioProfissao").val(profissao.salario);
         $("#id").val(profissao.id);

     }else{
         alert('Não foi possível encontrar a Profissão');
     }
 };
 
 
 function excluirProfissao(id){
   renderizaSelectProfissao();
    listaProfissao= listaProfissao.filter(function(value){
             return value.id != id;
         });
 
     gravaNoLocalStorageProfissao();
     renderizaProfissao();
 };

 function findProfissaoById(id){
    let profissao = listaProfissao.filter(function(value){
            return value.id == id;
        });
    
    if(profissao.length == 0){
        return undefined;
    }else{
        return profissao[0];
    }
};


function zerarInputsProfissao(){
    $('#formularioProfissao input').val('');
};
 
 function gravaNoLocalStorageProfissao(){
    // convertendo a lista em string no formato JSON
    const listaEmJSON = JSON.stringify(listaProfissao);

    // gravando no localStorage
    localStorage.setItem("listaProfissao", listaEmJSON);
};

function buscaDoLocalStorageProfissao(){
    // busca do local storage
    const listaStorage = localStorage.getItem("listaProfissao");

    // converte para lista e atribui
    listaProfissao = JSON.parse(listaStorage) || [];
}

buscaDoLocalStorageProfissao();
renderizaProfissao();
renderizaSelectProfissao();

$("#formularioProfissao").on("submit", function(evt){
        salvarProfissao();
        // corta a linha de execucao
        evt.stopPropagation(); 

        // previne o comportamento padrão
        evt.preventDefault();
    });



    function renderizaSelectProfissao(){
        const corpoSelect = $('#profissao-funcionario');
        corpoSelect.html('');

        for (let i = 0; i < listaProfissao.length; i++) {
            const profissao = listaProfissao[i];
            
            let linha = $('<option>');
            linha.html(profissao.nome);
            corpoSelect.append(linha);

            
            
        }
    };

    function renderizaSelectCidade(){
        const corpoSelectcidade = $('#cidade-funcionario');
        corpoSelectcidade.html('');

        for (let i = 0; i < listaCidades; i++) {
            const cidades = listaCidades[i];
            
            let linhacidade = $('<option>');
            linhacidade.html(cidades.nome +" "+ cidades.estado);
            corpoSelectcidade.append(linhacidade);

            
            
        }
    };








    //CIDADES
    // executa assim que a página terminar de carregar

    
    var listaCidades = [];
    
    function salvarCidades(){
        var cidades = {};
    
        cidades.nome =$("#nomeCidades").val();
        cidades.estado = $("#estadoCidades").val();
        cidades.CEP = $("#CEPCidades").val();
       

        let idCidade = $("#idCidade").val();
    
        // não tenho código = criar novo
        if(idCidade == undefined || idCidade == ''){
            cidades.idCidade = new Date().getTime();
            listaCidades.push(cidades);
        } else { // se tenho id, estou editando
            let idNumberss = parseInt(idCidade);
            let cidadesExistentes = findCidadesById(idNumberss);
            
            if(cidadesExistentes){
                cidadesExistentes.nome = cidades.nome;
                cidadesExistentes.estado = cidades.estado;
                cidadesExistentes.CEP = cidades.CEP;
               
            }
        }
    
        gravaNoLocalStorageCidades();
        renderizaCidades();
        zerarInputsCidades();
    
        return false;
    };
    
    function renderizaCidades(){
        // busco o tbody com o id
        const tbody = $("#corpo-tabela-cidades");
    
        // zerando o conteúdo da tabela
        tbody.html('');
    
        for(let i=0; i<listaCidades.length; i++){
            // Busco a pessoa da lista
            const cidades = listaCidades[i];
    
            // cria um elemento html do tipo tr
            // table row - linha da tabela
            let tr = $('<tr>');
    
            // cria um elemento html do tipo td
            // table data - dado da tabela
            let tdnomeCidades = $('<td>').text(cidades.nome);
            let tdestadoCidades = $('<td>').text(cidades.estado);
            let tdCEPCidades = $('<td>').text(cidades.CEP);
            let tdOpcoes = $('<td>');
    
            let btnEditarCidades = $('<button>').text('Editar');
            let btnExcluirCidades = $('<button>').text('Excluir');
            
            // associa o click a uma function
            btnEditarCidades.click(function(){ 
                editarCidades(cidades.idCidade); 
            });
    
            // associa o click a uma function
            btnExcluirCidades.click(function(){ 
                excluirCidades(cidades.idCidade); 
            });
            
            tdOpcoes.append(btnEditarCidades).append(btnExcluirCidades);
    
            // adiciono os td dentro do tr
            // na order a ser exibida
            tr.append(tdnomeCidades)
                .append(tdestadoCidades)
                .append(tdCEPCidades)
                .append(tdOpcoes);
    
            // adiciona o tr no tbody
            tbody.append(tr);
        }
    }
    
    function editarCidades(idCidade){
       let cidades = findCidadesById(idCidade);
    
        if(cidades){
            $("#nomeCidades").val(cidades.nome);
            $("#estadoCidades").val(cidades.estado);
            $("#CEPCidades").val(cidades.CEP);
            $("#idCidade").val(cidades.idCidade);

        }else{
            alert('Não foi possível encontrar a cidade');
        }
    }
    
    
    function excluirCidades(idCidade){
        listaCidades = listaCidades
            .filter(function(value){
                return value.idCidade != idCidade;
            });
    
        gravaNoLocalStorageCidades();
        renderizaCidades();
    }
    
    function findCidadesById(idCidade){
        let cidade = listaCidades
            .filter(function(value){
                return value.idCidade == idCidade;
            });
        
        if(cidades.length == 0){
            return undefined;
        }else{
            return cidades[0];
        }
    }
    
    function zerarInputsCidades(){
        $('#formularioCidade input').val('');
    }
    
    function gravaNoLocalStorageCidades(){
        // convertendo a lista em string no formato JSON
        const listaEmJSONN = JSON.stringify(listaCidades);
    
        // gravando no localStorage
        localStorage.setItem("listaCidades", listaEmJSONN);
    }
    
    function buscaDoLocalStorageCidades(){
        // busca do local storage
        const listaStorage = localStorage.getItem("listaCidades");
    
        // converte para lista e atribui
        listaCidades = JSON.parse(listaStorage) || [];
    }
    
        // o que se deseja executar
        buscaDoLocalStorageCidades();
        renderizaCidades();
    
        $("#formularioCidade").on("submit", function(evt){
                salvarCidades();
                // corta a linha de execucao
                evt.stopPropagation(); 
    
                // previne o comportamento padrão
                evt.preventDefault();
            });
        
        
        
    
})();
